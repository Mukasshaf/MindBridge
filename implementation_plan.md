# TeenCare Implementation Plan

# Goal Description
Build a web system "TeenCare" comprising a React frontend and FastAPI backend. The system features a supportive LLM chatbot for intake and a gamified quiz module for behavioral data collection. It includes a Counselor Dashboard to view rule-based session summaries.

## User Review Required
> [!IMPORTANT]
> - **LLM Integration**: We will implement a "Simulated LLM" mode by default for offline/demo purposes, which returns deterministic JSON. Real LLM integration (OpenAI-compatible) will be structured as a drop-in replacement.
> - **Data Persistence**: SQLite will be used for simplicity.
> - **Privacy**: No PII will be stored; only anonymous IDs.

## Proposed Changes

### Architecture
- **Frontend**: React + Vite + Tailwind CSS
- **Backend**: FastAPI + Uvicorn
- **Database**: SQLite (via SQLModel)
- **Deployment**: Local execution (Uvicorn + Vite)

### Backend (FastAPI)

#### [NEW] `backend/`
- `main.py`: App entry point, CORS setup.
- `models.py`: SQLModel definitions.
    - `Session`: `id`, `participant_id`, `created_at`, `source` (chat/quiz), `urgency`, `meta` (JSON), `raw_data` (JSON), `report` (JSON).
- `database.py`: DB connection and session management.
- `api/routes.py`:
    - `POST /api/session`: Create/Ingest session data.
    - `POST /api/session/{id}/complete`: Generate summary.
    - `GET /api/sessions`: List sessions.
    - `GET /api/session/{id}`: Get details.
    - `POST /api/llm`: Chatbot interaction (Simulated/Real).
    - `GET /api/session/{id}/export/pdf`: Generate PDF.
- `scoring.py`:
    - `calculate_stress_score()`
    - `calculate_attention_score()`
    - `generate_summary()`: Rule-based logic.
- `llm_service.py`:
    - System prompt definition.
    - `simulate_response()`: Fallback logic.
    - `parse_llm_json()`: Extract structured data.

### Frontend (React - via Lovable)

#### [NEW] `frontend/`
- **Source**: Generated by Lovable using the provided prompt.
- **Integration**:
    - Must be configured to proxy requests to `http://localhost:8000`.
    - Components must match the data models expected by the backend.

### Scripts

#### [NEW] `scripts/`
- `generate_demo_sessions.py`: Python script to populate DB with 20 synthetic sessions using the `Session` model.

## Verification Plan

### Automated Tests
- **Backend**: Unit tests for `scoring.py` to ensure rules (Stress Score, Attention Score) work as defined.
- **API**: Test endpoints for 200 OK and correct JSON structure.

### Manual Verification
- **Chat Flow**: Run a full chat session, verify "Simulate LLM" returns expected JSON, and session is saved.
- **Quiz Flow**: Complete all 3 tasks, submit, check if scores are calculated in backend.
- **Dashboard**: Open dashboard, verify list is populated (after running demo script), and PDF export works.
